
package ch.coursjava.meteo.graph;

import java.awt.BorderLayout;
import java.awt.Color;
import java.util.Date;

import javax.swing.JPanel;

import org.jfree.chart.ChartFactory;
import org.jfree.chart.ChartPanel;
import org.jfree.chart.JFreeChart;
import org.jfree.chart.axis.NumberAxis;
import org.jfree.chart.plot.XYPlot;
import org.jfree.data.time.Second;
import org.jfree.data.time.TimeSeries;
import org.jfree.data.time.TimeSeriesCollection;
import org.jfree.ui.RectangleInsets;

public class JPanelSimpleGraph extends JPanel
	{

	/*------------------------------------------------------------------*\
	|*							Constructeurs							*|
	\*------------------------------------------------------------------*/

	public JPanelSimpleGraph(String graphTitle)
		{
		this.graphTitle = graphTitle;

		geometry();
		control();
		appearance();
		}

	/*------------------------------------------------------------------*\
	|*							Methodes Public							*|
	\*------------------------------------------------------------------*/
	public void addValue(double x, double y)
		{
		timeSerie.add(new Second(new Date((long)x)), y);
		if (timeSerie.getItemCount() > 100)
			{

			}
		}

	/*------------------------------*\
	|*				Set				*|
	\*------------------------------*/

	/*------------------------------*\
	|*				Get				*|
	\*------------------------------*/

	/*------------------------------------------------------------------*\
	|*							Methodes Private						*|
	\*------------------------------------------------------------------*/

	private void geometry()
		{
		timeSerie = new TimeSeries(graphTitle);
		dataset = new TimeSeriesCollection();

		dataset.addSeries(timeSerie);

		JFreeChart chart = createChart();
		chartPanel = new ChartPanel(chart);

		setLayout(new BorderLayout());

		add(chartPanel, BorderLayout.CENTER);
		}

	private void control()
		{
		// rien
		}

	private void appearance()
		{
		//rien
		}

	private JFreeChart createChart()
		{
		// create the chart...
		final JFreeChart chart = ChartFactory.createTimeSeriesChart(graphTitle, // chart title
				"Time (s)", // x axis label
				graphTitle, // y axis label
				dataset, // data
				true, // include legend
				true, // tooltips
				false // urls
				);

		// NOW DO SOME OPTIONAL CUSTOMISATION OF THE CHART...
		chart.setBackgroundPaint(Color.white);

		// get a reference to the plot for further customisation...
		final XYPlot plot = chart.getXYPlot();

		plot.setBackgroundPaint(Color.darkGray);
		plot.setAxisOffset(new RectangleInsets(5.0, 5.0, 5.0, 5.0));
		plot.setDomainCrosshairVisible(true);
		plot.setRangeCrosshairVisible(true);
		plot.setDomainGridlinePaint(Color.lightGray);
		plot.setRangeGridlinePaint(Color.lightGray);

		// change the auto tick unit selection to integer units only...
		plot.getRangeAxis().setStandardTickUnits(NumberAxis.createIntegerTickUnits());
		plot.getDomainAxis().setStandardTickUnits(NumberAxis.createIntegerTickUnits());

		// OPTIONAL CUSTOMISATION COMPLETED.

		return chart;
		}

	/*------------------------------------------------------------------*\
	|*							Attributs Private						*|
	\*------------------------------------------------------------------*/

	// Input
	private String graphTitle;

	// Tools
	private TimeSeries timeSerie;
	private TimeSeriesCollection dataset;
	private ChartPanel chartPanel;

	}
